seqs <- stripped[,-1]
seq.freq <- table(unlist(seqs))
seq.freq <- sort(seq.freq, decreasing = T)

#return a table of the frequnecies of the powers of n
#up to n^k
powerFreq <- function(n, k){
  subset <- as.table(seq.freq["1"])
  for(i in 1:k){
    subset <- c(subset, seq.freq[toString(n^i)])
  }
  return(subset)
}

#create a dataframe where the nth column is a table of the
#frequencies of the powers of n
maxN <- 16  #the biggest base
maxK <- 100 #the biggest power

power.frame <- as.data.frame(powerFreq(1,maxK));
for(i in 2:maxN){
  power.frame <- data.frame(power.frame, powerFreq(i, maxK))
}

#remove the 0th power
power.frame <- power.frame[-1,]

colnames(power.frame) <- 1:maxN
rownames(power.frame) <- 1:maxK

#create an array where the index represents n
#and the value is the freqencies of all powers of n up to n^maxK
power.sums <- as.array(power.frame[1,1]) #first take the powers of 1
for(i in 2:maxN){
  power.sums[i] <- sum(power.frame[,i], na.rm=T)
}

